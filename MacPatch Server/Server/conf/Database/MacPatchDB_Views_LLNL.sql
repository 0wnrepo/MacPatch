/*
	MacPatch Database Schema
	LLNL Specific Views
	Version 2.1.0
*/

SET NAMES utf8;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
--  View structure for `mp_cmdb_view`
-- ----------------------------
DROP VIEW IF EXISTS `mp_cmdb_view`;
CREATE ALGORITHM=UNDEFINED SQL SECURITY DEFINER VIEW `mp_cmdb_view` AS select `mpcv`.`cuuid` AS `MP_CLIENT_ID`,`mpcv`.`computername` AS `COMPUTERNAME`,`mpcv`.`hostname` AS `HOSTNAME`,`mpcv`.`serialNo` AS `EQP_SER_NO`,`mpcv`.`osver` AS `OS_VERSION`,`mpcv`.`ostype` AS `OS_MAJ_VER_STD_NAM`,`hw`.`mpa_Processor_Name` AS `CPU`,`hw`.`mpa_Memory` AS `RAM`,`hw`.`mpa_Model_Identifier` AS `EQP_MODEL_ID`,`hw`.`mpa_Model_Name` AS `EQP_MODEL_NAM`,`ds`.`mpa_distinguishedName` AS `AD_PATH`,`ds`.`mpa_HasSLAM` AS `HAS_SLAM` from ((`mp_clients_view` `mpcv` left join `mpi_SPHardwareOverview` `hw` on((`hw`.`cuuid` = `mpcv`.`cuuid`))) left join `mpi_DirectoryServices` `ds` on((`ds`.`cuuid` = `mpcv`.`cuuid`)));

-- ----------------------------
--  View structure for `bcb_combined_patches_view`
-- ----------------------------
DROP VIEW IF EXISTS `bcb_combined_patches_view`;
CREATE ALGORITHM=UNDEFINED SQL SECURITY DEFINER VIEW `bcb_combined_patches_view` AS select distinct `ap`.`akey` AS `id`,`ap`.`patchname` AS `name`,`ap`.`version` AS `version`,`ap`.`postdate` AS `postdate`,`ap`.`title` AS `title`,(case when (`ap`.`restartaction` = _latin1'NoRestart') then _latin1'No' when (`ap`.`restartaction` = _latin1'RequireRestart') then _latin1'Yes' end) AS `reboot`,_latin1'Apple' AS `type`,`ap`.`supatchname` AS `suname`,1 AS `active`,`api`.`severity` AS `severity`,`api`.`patch_state` AS `patch_state`,0 AS `size`,_latin1'' AS `MoreInfoURL` from (`apple_patches_real` `ap` left join `apple_patches` `api` on((`api`.`akey` = `ap`.`akey`))) where ((`api`.`patch_state` = 'Production') or (`api`.`patch_state` = 'QA')) union all select `mp_patches`.`puuid` AS `id`,`mp_patches`.`patch_name` AS `name`,`mp_patches`.`patch_ver` AS `version`,`mp_patches`.`cdate` AS `postdate`,`mp_patches`.`description` AS `title`,`mp_patches`.`patch_reboot` AS `reboot`,_latin1'Third' AS `type`,concat(`mp_patches`.`patch_name`,_latin1'-',`mp_patches`.`patch_ver`) AS `suname`,`mp_patches`.`active` AS `active`,`mp_patches`.`patch_severity` AS `severity`,`mp_patches`.`patch_state` AS `patch_state`,`mp_patches`.`pkg_size` AS `size`,`mp_patches`.`description_url` AS `MoreInfoURL` from `mp_patches` where ((`mp_patches`.`patch_state` = 'Production') or (`mp_patches`.`patch_state` = 'QA'));

-- ----------------------------
--  View structure for `bcb_combined_patches_view_copy`
-- ----------------------------
DROP VIEW IF EXISTS `bcb_combined_patches_view_copy`;
CREATE ALGORITHM=UNDEFINED SQL SECURITY DEFINER VIEW `bcb_combined_patches_view_copy` AS select distinct `ap`.`akey` AS `id`,`ap`.`patchname` AS `name`,`ap`.`version` AS `version`,`ap`.`postdate` AS `postdate`,`ap`.`title` AS `title`,(case when (`ap`.`restartaction` = _latin1'NoRestart') then _latin1'No' when (`ap`.`restartaction` = _latin1'RequireRestart') then _latin1'Yes' end) AS `reboot`,_latin1'Apple' AS `type`,`ap`.`supatchname` AS `suname`,1 AS `active`,`api`.`severity` AS `severity`,`api`.`patch_state` AS `patch_state`,0 AS `size`,_latin1'' AS `MoreInfoURL` from (`apple_patches_real` `ap` left join `apple_patches` `api` on((`api`.`akey` = `ap`.`akey`))) where (`api`.`patch_state` = 'Production') union all select `mp_patches`.`puuid` AS `id`,`mp_patches`.`patch_name` AS `name`,`mp_patches`.`patch_ver` AS `version`,`mp_patches`.`cdate` AS `postdate`,`mp_patches`.`description` AS `title`,`mp_patches`.`patch_reboot` AS `reboot`,_latin1'Third' AS `type`,concat(`mp_patches`.`patch_name`,_latin1'-',`mp_patches`.`patch_ver`) AS `suname`,`mp_patches`.`active` AS `active`,`mp_patches`.`patch_severity` AS `severity`,`mp_patches`.`patch_state` AS `patch_state`,`mp_patches`.`pkg_size` AS `size`,`mp_patches`.`description_url` AS `MoreInfoURL` from `mp_patches` where (`mp_patches`.`patch_state` = 'Production');

-- ----------------------------
--  View structure for `bcb_mp_clients_info_view`
-- ----------------------------
DROP VIEW IF EXISTS `bcb_mp_clients_info_view`;
CREATE ALGORITHM=UNDEFINED SQL SECURITY DEFINER VIEW `bcb_mp_clients_info_view` AS select `a`.`cuuid` AS `cuuid`,`a`.`hostname` AS `hostname`,`a`.`computername` AS `computername`,`a`.`ipaddr` AS `ipaddr`,replace(`a`.`macaddr`,':','-') AS `macaddr`,`a`.`osver` AS `osver`,`a`.`ostype` AS `ostype`,`a`.`mdate` AS `sdate`,`a`.`serialNo` AS `serialNo` from `mp_clients` `a`;

-- ----------------------------
--  View structure for `bcb_savav_info_view`
-- ----------------------------
DROP VIEW IF EXISTS `bcb_savav_info_view`;
CREATE ALGORITHM=UNDEFINED SQL SECURITY DEFINER VIEW `bcb_savav_info_view` AS select `savav_info`.`cuuid` AS `cuuid`,`savav_info`.`defsDate` AS `defsDate`,`savav_info`.`savShortVersion` AS `savShortVersion`,`savav_info`.`savAppName` AS `savAppName`,`savav_info`.`mdate` AS `mdate` from `savav_info`;

-- ----------------------------
--  View structure for `mpi_SPHardwareOverview_view`
-- ----------------------------
DROP VIEW IF EXISTS `mpi_SPHardwareOverview_view`;
CREATE ALGORITHM=UNDEFINED SQL SECURITY DEFINER VIEW `mpi_SPHardwareOverview_view` AS select `mpi_SPHardwareOverview`.`rid` AS `rid`,`mpi_SPHardwareOverview`.`cuuid` AS `cuuid`,`mpi_SPHardwareOverview`.`mdate` AS `mdate`,`mpi_SPHardwareOverview`.`mpa_Processor_Speed` AS `mpa_Processor_Speed`,`mpi_SPHardwareOverview`.`mpa_Boot_ROM_Version` AS `mpa_Boot_ROM_Version`,`mpi_SPHardwareOverview`.`mpa_Total_Number_of_Cores` AS `mpa_Total_Number_Of_Cores`,`mpi_SPHardwareOverview`.`mpa_Number_of_Processors` AS `mpa_Number_Of_Processors`,`mpi_SPHardwareOverview`.`mpa_Memory` AS `mpa_Memory`,`mpi_SPHardwareOverview`.`mpa_L2_Cache` AS `mpa_L2_Cache`,`mpi_SPHardwareOverview`.`mpa_L3_Cache` AS `mpa_L3_Cache`,`mpi_SPHardwareOverview`.`mpa_Hardware_UUID` AS `mpa_Hardware_UUID`,`mpi_SPHardwareOverview`.`mpa_Model_Identifier` AS `mpa_Model_Identifier`,`mpi_SPHardwareOverview`.`mpa_Processor_Name` AS `mpa_Processor_Name`,`mpi_SPHardwareOverview`.`mpa_SMC_Version` AS `mpa_SMC_Version`,`mpi_SPHardwareOverview`.`mpa_Serial_Number` AS `mpa_Serial_Number`,`mpi_SPHardwareOverview`.`mpa_Bus_Speed` AS `mpa_Bus_Speed`,`mpi_SPHardwareOverview`.`mpa_Model_Name` AS `mpa_Model_Name`,`mpi_SPHardwareOverview`.`mpa_Sudden_Motion_Sensor` AS `mpa_Sudden_Motion_Sensor`,`mpi_SPHardwareOverview`.`mpa_State` AS `mpa_State`,`mpi_SPHardwareOverview`.`mpa_Processor_Interconnect_Speed` AS `mpa_Processor_Interconnect`,`mpi_SPHardwareOverview`.`mpa_Serial_Number_(processor_tray)` AS `mpa_Serial_Number_pt`,`mpi_SPHardwareOverview`.`mpa_SMC_Version_(processor_tray)` AS `mpa_SMC_Version_pt`,`mpi_SPHardwareOverview`.`mpa_L3_Cache_(per_Processor)` AS `mpa_L3_Cache_pt` from `mpi_SPHardwareOverview`;

-- ----------------------------
--  View structure for `mpi_SPNetwork_view`
-- ----------------------------
DROP VIEW IF EXISTS `mpi_SPNetwork_view`;
CREATE ALGORITHM=UNDEFINED SQL SECURITY DEFINER VIEW `mpi_SPNetwork_view` AS select `mpi_SPNetwork`.`rid` AS `rid`,`mpi_SPNetwork`.`cuuid` AS `cuuid`,`mpi_SPNetwork`.`mpa_Name` AS `mpa_Name`,`mpi_SPNetwork`.`mpa_Type` AS `mpa_Type`,`mpi_SPNetwork`.`mpa_Hardware` AS `mpa_Hardware`,`mpi_SPNetwork`.`mpa_BSD_Device_Name` AS `mpa_BSD_Device_Name`,`mpi_SPNetwork`.`mpa_Has_IP_Assigned` AS `mpa_Has_IP_Assigned`,`mpi_SPNetwork`.`mpa_IPv4_Addresses` AS `mpa_IPv4_Addresses`,`mpi_SPNetwork`.`mpa_IPv4_Configuration_Method` AS `mpa_IPv4_Confi_Method`,`mpi_SPNetwork`.`mpa_IPv4_Interface_Name` AS `mpa_IPv4_Interface_Name`,`mpi_SPNetwork`.`mpa_IPv4_NetworkSignature` AS `mpa_IPv4_NetworkSignature`,`mpi_SPNetwork`.`mpa_IPv4_Router` AS `mpa_IPv4_Router`,`mpi_SPNetwork`.`mpa_IPv4_Subnet_Masks` AS `mpa_IPv4_Subnet_Masks`,`mpi_SPNetwork`.`mpa_AppleTalk_Default_Zone` AS `mpa_AppleTalk_Default_Zone`,`mpi_SPNetwork`.`mpa_AppleTalk_Interface_Name` AS `mpa_AppleTalk_Interface_Name`,`mpi_SPNetwork`.`mpa_AppleTalk_Network_ID` AS `mpa_AppleTalk_Network_ID`,`mpi_SPNetwork`.`mpa_AppleTalk_Node_ID` AS `mpa_AppleTalk_Node_ID`,`mpi_SPNetwork`.`mpa_DNS_Search_Domains` AS `mpa_DNS_Search_Domains`,`mpi_SPNetwork`.`mpa_DNS_Server_Addresses` AS `mpa_DNS_Server_Addresses`,`mpi_SPNetwork`.`mpa_Proxies_Exceptions_List` AS `mpa_Proxies_Exceptions_List`,`mpi_SPNetwork`.`mpa_Proxies_FTP_Passive_Mode` AS `mpa_Proxies_FTP_Passive_Mode`,`mpi_SPNetwork`.`mpa_Proxies_HTTP_Proxy_Enabled` AS `mpa_Proxies_HTTP_Enabled`,`mpi_SPNetwork`.`mpa_Proxies_HTTP_Proxy_Port` AS `mpa_Proxies_HTTP_Port`,`mpi_SPNetwork`.`mpa_Proxies_HTTP_Proxy_Server` AS `mpa_Proxies_HTTP_Server`,`mpi_SPNetwork`.`mpa_Ethernet_MAC_Address` AS `mpa_Ethernet_MAC_Address`,`mpi_SPNetwork`.`mpa_Ethernet_Media_Options` AS `mpa_Ethernet_Media_Options`,`mpi_SPNetwork`.`mpa_Ethernet_Media_Subtype` AS `mpa_Ethernet_Media_Subtype`,`mpi_SPNetwork`.`mpa_IPv4_Network_Signature` AS `mpa_IPv4_Network_Signature`,`mpi_SPNetwork`.`mpa_Configuration_Method` AS `mpa_Configuration_Method`,`mpi_SPNetwork`.`mpa_Proxies_Service_Order` AS `mpa_Proxies_Service_Order`,`mpi_SPNetwork`.`mpa_Proxies_FTP_Proxy_Enabled` AS `mpa_Proxies_FTP_Enabled`,`mpi_SPNetwork`.`mpa_Proxies_Gopher_Proxy_Enabled` AS `mpa_Proxies_Gopher_Enabled`,`mpi_SPNetwork`.`mpa_Proxies_HTTPS_Proxy_Enabled` AS `mpa_Proxies_HTTPS_Enabled`,`mpi_SPNetwork`.`mpa_Proxies_RTSP_Proxy_Enabled` AS `mpa_Proxies_RTSP_Enabled`,`mpi_SPNetwork`.`mpa_Proxies_SOCKS_Proxy_Enabled` AS `mpa_Proxies_SOCKS_Enabled`,`mpi_SPNetwork`.`mpa_Ethernet_Hardware_Type` AS `mpa_Ethernet_Hardware_Type`,`mpi_SPNetwork`.`mpa_DNS_Domain_Name` AS `mpa_DNS_Domain_Name`,`mpi_SPNetwork`.`mpa_Domain_Name` AS `mpa_Domain_Name`,`mpi_SPNetwork`.`mpa_Domain_Name_Servers` AS `mpa_Domain_Name_Servers`,`mpi_SPNetwork`.`mpa_Lease_Duration_(seconds)` AS `mpa_Lease_Duration_(seconds)`,`mpi_SPNetwork`.`mpa_DHCP_Message_Type` AS `mpa_DHCP_Message_Type`,`mpi_SPNetwork`.`mpa_Routers` AS `mpa_Routers`,`mpi_SPNetwork`.`mpa_Server_Identifier` AS `mpa_Server_Identifier`,`mpi_SPNetwork`.`mpa_Subnet_Mask` AS `mpa_Subnet_Mask`,`mpi_SPNetwork`.`mpa_Media_Subtype` AS `mpa_Media_Subtype`,`mpi_SPNetwork`.`mpa_AppleTalk_Network_Range` AS `mpa_AppleTalk_Network_Range`,`mpi_SPNetwork`.`mpa_AppleTalk_Node` AS `mpa_AppleTalk_Node`,`mpi_SPNetwork`.`mpa_Proxies_FTP_Proxy_Port` AS `mpa_Proxies_FTP_Proxy_Port`,`mpi_SPNetwork`.`mpa_Proxies_FTP_Proxy_Server` AS `mpa_Proxies_FTP_Proxy_Server`,`mpi_SPNetwork`.`mpa_IPv4_DHCP_Client_ID` AS `mpa_IPv4_DHCP_Client_ID`,`mpi_SPNetwork`.`mpa_IPv4_Hostname` AS `mpa_IPv4_Hostname`,`mpi_SPNetwork`.`mpa_Addresses` AS `mpa_Addresses`,`mpi_SPNetwork`.`mpa_Prefix_Length` AS `mpa_Prefix_Length`,`mpi_SPNetwork`.`mpa_IPv4_Destination_Addresses` AS `mpa_IPv4_Destination_Addresses`,`mpi_SPNetwork`.`mpa_Supplemental_Match_Orders` AS `mpa_Supplemental_Match_Orders`,`mpi_SPNetwork`.`mpa_FTP_Proxy_Enabled` AS `mpa_FTP_Proxy_Enabled`,`mpi_SPNetwork`.`mpa_FTP_Passive_Mode` AS `mpa_FTP_Passive_Mode`,`mpi_SPNetwork`.`mpa_FTP_Proxy_Port` AS `mpa_FTP_Proxy_Port`,`mpi_SPNetwork`.`mpa_Gopher_Proxy_Enabled` AS `mpa_Gopher_Proxy_Enabled`,`mpi_SPNetwork`.`mpa_Gopher_Proxy_Port` AS `mpa_Gopher_Proxy_Port`,`mpi_SPNetwork`.`mpa_HTTP_Proxy_Enabled` AS `mpa_HTTP_Proxy_Enabled`,`mpi_SPNetwork`.`mpa_HTTP_Proxy_Port` AS `mpa_HTTP_Proxy_Port`,`mpi_SPNetwork`.`mpa_HTTPS_Proxy_Enabled` AS `mpa_HTTPS_Proxy_Enabled`,`mpi_SPNetwork`.`mpa_HTTPS_Proxy_Port` AS `mpa_HTTPS_Proxy_Port`,`mpi_SPNetwork`.`mpa_RTSP_Proxy_Enabled` AS `mpa_RTSP_Proxy_Enabled`,`mpi_SPNetwork`.`mpa_RTSP_Proxy_Port` AS `mpa_RTSP_Proxy_Port`,`mpi_SPNetwork`.`mpa_SOCKS_Proxy_Enabled` AS `mpa_SOCKS_Proxy_Enabled`,`mpi_SPNetwork`.`mpa_SOCKS_Proxy_Port` AS `mpa_SOCKS_Proxy_Port`,`mpi_SPNetwork`.`mpa_Option_Overload` AS `mpa_Option_Overload`,`mpi_SPNetwork`.`mpa_Marginal_Power` AS `mpa_Marginal_Power`,`mpi_SPNetwork`.`mpa_Metric` AS `mpa_Metric`,`mpi_SPNetwork`.`mpa_Portability` AS `mpa_Portability`,`mpi_SPNetwork`.`mpa_Total_Power` AS `mpa_Total_Power`,`mpi_SPNetwork`.`mpa_Service_Order` AS `mpa_Service_Order`,`mpi_SPNetwork`.`mpa_Server_Addresses` AS `mpa_Server_Addresses`,`mpi_SPNetwork`.`mpa_Ethernet_Service_Order` AS `mpa_Ethernet_Service_Order`,`mpi_SPNetwork`.`mpa_Hardware_Type` AS `mpa_Hardware_Type`,`mpi_SPNetwork`.`mpa_Flags` AS `mpa_Flags`,`mpi_SPNetwork`.`mpa_Interface_Name` AS `mpa_Interface_Name`,`mpi_SPNetwork`.`mpa_Router` AS `mpa_Router`,`mpi_SPNetwork`.`mpa_ipv6_address` AS `mpa_ipv6_address`,`mpi_SPNetwork`.`mpa_DNS_Supplemental_Match_Domains` AS `mpa_DNS_SupplementMatchDomains`,`mpi_SPNetwork`.`mpa_DNS_SupplementalMatchOrder` AS `mpa_DNS_SupplementMatchOrder`,`mpi_SPNetwork`.`mpa_Proxies_IPv6_Address` AS `mpa_Proxies_IPv6_Address`,`mpi_SPNetwork`.`mpa_Ethernet_ipv6_address` AS `mpa_Ethernet_ipv6_address`,`mpi_SPNetwork`.`dateInt` AS `dateInt`,`mpi_SPNetwork`.`mdate` AS `mdate`,`mpi_SPNetwork`.`mpa_DHCP_Routers` AS `mpa_DHCP_Routers`,`mpi_SPNetwork`.`mpa_DHCP_Domain_Name_Servers` AS `mpa_DHCP_Domain_Name_Servers`,`mpi_SPNetwork`.`mpa_DHCP_Lease_Duration_seconds` AS `mpa_DHCP_Lease_Duration_Secs`,`mpi_SPNetwork`.`mpa_DHCP_Domain_Name` AS `mpa_DHCP_Domain_Name`,`mpi_SPNetwork`.`mpa_DHCP_Server_Identifier` AS `mpa_DHCP_Server_Identifier`,`mpi_SPNetwork`.`mpa_DHCP_DHCP_Message_Type` AS `mpa_DHCP_DHCP_Message_Type`,`mpi_SPNetwork`.`mpa_DHCP_Subnet_Mask` AS `mpa_DHCP_Subnet_Mask`,`mpi_SPNetwork`.`mpa_Subnet_Masks` AS `mpa_Subnet_Masks`,`mpi_SPNetwork`.`mpa_AppleTalk_Configuration_Method` AS `mpa_AppleTalk_Config_Method` from `mpi_SPNetwork`;

-- ----------------------------
--  View structure for `mpi_SPSystemOverview_view`
-- ----------------------------
DROP VIEW IF EXISTS `mpi_SPSystemOverview_view`;
CREATE ALGORITHM=UNDEFINED SQL SECURITY DEFINER VIEW `mpi_SPSystemOverview_view` AS select `mpi_SPSystemOverview`.`rid` AS `rid`,`mpi_SPSystemOverview`.`cuuid` AS `cuuid`,`mpi_SPSystemOverview`.`mpa_Name` AS `mpa_Name`,`mpi_SPSystemOverview`.`mpa_System_Version` AS `mpa_System_Version`,`mpi_SPSystemOverview`.`mpa_Kernel_Version` AS `mpa_Kernel_Version`,`mpi_SPSystemOverview`.`mpa_Boot_Volume` AS `mpa_Boot_Volume`,`mpi_SPSystemOverview`.`mpa_Boot_Mode` AS `mpa_Boot_Mode`,`mpi_SPSystemOverview`.`mpa_Computer_Name` AS `mpa_Computer_Name`,`mpi_SPSystemOverview`.`mpa_User_Name` AS `mpa_User_Name`,`mpi_SPSystemOverview`.`mpa_Time_since_boot` AS `mpa_Time_since_boot`,`mpi_SPSystemOverview`.`mpa_Secure_Virtual_Memory` AS `mpa_Secure_Virtual_Memory`,`mpi_SPSystemOverview`.`mpa_64-bit_Kernel_and_Extensions` AS `mpa_64-bit_Kernel_Extensions`,`mpi_SPSystemOverview`.`mpa_Server_Configuration` AS `mpa_Server_Configuration`,`mpi_SPSystemOverview`.`mdate` AS `mdate` from `mpi_SPSystemOverview`;

SET FOREIGN_KEY_CHECKS = 1;